{% extends 'base.html' %} {# Corrected path to base.html #}

{% block title %}{{ page_title }}{% endblock %} {# page_title is for the <title> tag, set in build_static_site.py #}

{% block extra_css %}
<style>
    .hero {
        position: relative;
        /* Ensure hero_background.jpg is in your core/static/core/img/ directory */
        background: url('{{ STATIC_URL }}img/hero_background.jpg') no-repeat center center; 
        background-size: cover;
        color: white;
        padding: 100px 0; 
        text-align: left;
    }
    .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 51, 102, 0.6); 
    }
    .hero-content {
        position: relative; 
        z-index: 1;
    }
    .feature-icon {
        font-size: 2.5rem; 
        color: var(--bs-primary); 
        margin-bottom: 1rem; 
        width: 70px; 
        height: 70px; 
        border-radius: 50%; 
        background-color: #e9ecef; 
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .metric-card {
        background-color: #f8f9fa;
        padding: 1.5rem;
        border-radius: 0.5rem;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .metric-value {
        font-size: 2rem;
        font-weight: bold;
        color: var(--bs-primary);
    }
    .metric-label {
        font-size: 0.9rem;
        color: #6c757d;
    }
    .chart-container {
        background-color: #ffffff;
        padding: 1.5rem;
        border-radius: 0.5rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        height: 350px; 
    }
    .fade-in {
      animation: fadeInAnimation ease 2s;
      animation-iteration-count: 1;
      animation-fill-mode: forwards;
    }
    @keyframes fadeInAnimation {
      0% {
          opacity: 0;
          transform: translateY(20px);
      }
      100% {
          opacity: 1;
          transform: translateY(0);
       }
    }
    /* Define bs-primary if not already defined by Bootstrap or your main style.css */
    :root {
        --bs-primary: #0d6efd; /* Default Bootstrap primary blue */
    }
</style>
{% endblock %}

{% block content %}
<section class="hero">
    <div class="hero-overlay"></div>
    <div class="container hero-content">
        <div class="row align-items-center">
            <div class="col-lg-7 fade-in">
                <h1>{{ hero_title }}</h1> {# Use hero_title from context #}
                <p class="lead mb-4">UrbanPulse provides comprehensive data analytics on cities, buildings, safety, and urban development to inform your investment decisions and urban planning strategies.</p>
                <div class="d-flex gap-3 flex-wrap"> 
                    <a href="/investment/" class="btn btn-light btn-lg">Explore Data Insights</a> 
                    <a href="/contact/" class="btn btn-outline-light btn-lg">Contact Us</a> 
                </div>
            </div>
            </div>
    </div>
</section>

<section class="features bg-white py-5">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-lg-8 mx-auto">
                <h2 class="mb-3">Comprehensive Urban Intelligence</h2>
                <p class="lead text-muted">Our platform collects and analyzes data across multiple dimensions of urban environments to provide actionable insights.</p>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon mx-auto">
                        <i class="bi bi-building"></i>
                    </div>
                    <h4 class="card-title">Urban Infrastructure</h4>
                    <p class="card-text">Detailed data on buildings, infrastructure quality, occupancy rates, and maintenance history.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon mx-auto">
                        <i class="bi bi-shield-check"></i>
                    </div>
                    <h4 class="card-title">Safety & Compliance</h4>
                    <p class="card-text">Comprehensive safety records, inspection histories, and regulatory compliance data.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon mx-auto">
                        <i class="bi bi-graph-up-arrow"></i>
                    </div>
                    <h4 class="card-title">Investment Analytics</h4>
                    <p class="card-text">Identify promising investment opportunities with predictive analytics and trend forecasting.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon mx-auto">
                        <i class="bi bi-people"></i>
                    </div>
                    <h4 class="card-title">Population Insights</h4>
                    <p class="card-text">Demographic trends, population density, and movement patterns to inform urban planning.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon mx-auto">
                        <i class="bi bi-exclamation-triangle"></i>
                    </div>
                    <h4 class="card-title">Hazard Assessment</h4>
                    <p class="card-text">Analysis of environmental risks, natural hazards, and emergency response capabilities.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 p-4 text-center">
                    <div class="feature-icon mx-auto">
                        <i class="bi bi-leaf"></i>
                    </div>
                    <h4 class="card-title">Sustainability Metrics</h4>
                    <p class="card-text">Green energy installations, environmental impact assessments, and sustainability scores.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="insights py-5 bg-light">
    <div class="container">
        <div class="row mb-5">
            <div class="col-lg-8 mx-auto text-center">
                <h2 class="mb-3">Real-Time Urban Insights</h2>
                <p class="lead text-muted">Preview the power of our data analytics platform with these sample visualizations.</p>
            </div>
        </div>
        
        <div class="row mb-4 align-items-stretch">
            <div class="col-lg-6 mb-4">
                <div class="chart-container h-100">
                    <h4>Urban Development Trends</h4>
                    <p class="text-muted small">New construction permits by district (last 12 months)</p>
                    <canvas id="developmentChart"></canvas> 
                </div>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="chart-container h-100">
                    <h4>Safety Inspection Results</h4>
                    <p class="text-muted small">Building safety compliance rates by category</p>
                   <canvas id="safetyChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="row mb-4">
            {% if featured_insights %}
                {% for insight in featured_insights %}
                <div class="col-md-3 mb-4">
                    <div class="metric-card">
                        {# Ensure insight.icon, insight.value are always provided by Python script #}
                        <i class="bi {{ insight.icon }} text-primary mb-3" style="font-size: 2rem;"></i>
                        <div class="metric-value">{{ insight.value }}</div>
                        <div class="metric-label">{{ insight.title }}</div>
                    </div> 
                </div>
                {% endfor %}
            {% else %}
            <div class="col-md-3 mb-4"><div class="metric-card p-3"><div class="metric-label">Data unavailable</div></div></div>
            <div class="col-md-3 mb-4"><div class="metric-card p-3"><div class="metric-label">Data unavailable</div></div></div>
            <div class="col-md-3 mb-4"><div class="metric-card p-3"><div class="metric-label">Data unavailable</div></div></div>
            <div class="col-md-3 mb-4"><div class="metric-card p-3"><div class="metric-label">Data unavailable</div></div></div>
            {% endif %}
        </div>
        
        <div class="row">
            <div class="col-12 text-center">
                <a href="/investment/" class="btn btn-primary btn-lg">Explore Full Data Insights</a>
            </div>
        </div>
    </div>
</section>

<section class="use-cases bg-white py-5">
    <div class="container">
        <div class="row mb-5">
            <div class="col-lg-8 mx-auto text-center">
                <h2 class="mb-3">Success Stories</h2>
                <p class="lead text-muted">See how organizations leverage our urban data intelligence to make informed decisions.</p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Metropolitan Development Authority</h5>
                        <p class="card-text">Used UrbanPulse data to identify optimal locations for new public transportation hubs, resulting in a 24% increase in ridership and improved urban mobility.</p>
                        <div class="d-flex align-items-center mt-3">
                            <div class="bg-light rounded-circle p-2 me-3">
                                <i class="bi bi-building text-primary"></i>
                            </div>
                            <div><small class="text-muted">Urban Planning</small></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Greenfield Investments Group</h5>
                        <p class="card-text">Leveraged our hazard analysis and sustainability reports to identify low-risk, high-potential development areas, achieving 32% higher ROI than industry average.</p>
                        <div class="d-flex align-items-center mt-3">
                            <div class="bg-light rounded-circle p-2 me-3">
                                <i class="bi bi-cash-coin text-primary"></i>
                            </div>
                            <div><small class="text-muted">Investment Strategy</small></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-12 text-center">
                <a href="/services/" class="btn btn-outline-primary">View All Success Stories</a>
            </div>
        </div>
    </div>
</section>

<section class="cta py-5" style="background-color: #003366;">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center text-white">
                <h2 class="mb-4">Ready to Transform Your Urban Investment Strategy?</h2>
                <p class="lead mb-4">Join organizations worldwide that use UrbanPulse to make data-driven decisions for urban development and investment.</p>
                <div class="d-flex justify-content-center gap-3 flex-wrap">
                    <a href="#" class="btn btn-light btn-lg">Sign Up Free</a> 
                    <a href="/contact/" class="btn btn-outline-light btn-lg">Contact Sales</a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const developmentCtxElement = document.getElementById('developmentChart');
        if (developmentCtxElement) {
            const developmentCtx = developmentCtxElement.getContext('2d');
            new Chart(developmentCtx, {
                type: 'bar',
                data: {
                    labels: ['Downtown', 'North District', 'East Side', 'West End', 'South Quarter', 'Industrial Zone'],
                    datasets: [{
                        label: 'New Construction Permits',
                        data: [124, 86, 105, 73, 93, 52], 
                        backgroundColor: '#0066A4', 
                        borderColor: '#005c93',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } }, x: { grid: { display: false } } }
                }
            });
        }
        
        const safetyCtxElement = document.getElementById('safetyChart');
        if (safetyCtxElement) {
            const safetyCtx = safetyCtxElement.getContext('2d');
            new Chart(safetyCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Excellent', 'Good', 'Satisfactory', 'Needs Improvement', 'Critical'],
                    datasets: [{
                        data: [42, 28, 18, 8, 4], 
                        backgroundColor: ['#00A651', '#4CD964', '#4A90E2', '#FF9500', '#FF3B30'],
                        borderWidth: 2, 
                        borderColor: '#fff' 
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'right', labels: { padding: 15 } } },
                    cutout: '60%' 
                }
            });
        }
    });
</script>
{% endblock %}
